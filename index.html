<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nakshatra Vidhi - Vedic Astrology Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * { margin:0; padding:0; box-sizing:border-box }
    body { font-family:'Roboto',sans-serif; background: linear-gradient(135deg,#667eea,#764ba2); color:#333; min-height:100vh }
    .container { max-width:1200px; margin:auto; padding:20px }
    .header { text-align:center; color:#fff; margin-bottom:30px }
    .header h1 { font-family:'Roboto Condensed',sans-serif; font-size:3em; }
    .form-container { background:#fff; border-radius:15px; padding:30px; box-shadow:0 5px 15px rgba(0,0,0,0.1); margin-bottom:30px }
    .form-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px }
    .form-section { background:#f8f9fa; padding:20px; border-left:5px solid #667eea; border-radius:10px }
    .form-section h3 { color:#667eea; margin-bottom:15px; font-weight:500; display:flex; align-items:center; gap:8px }
    .form-group { margin-bottom:15px }
    .form-group label { display:block; margin-bottom:5px; font-weight:500 }
    .form-group input,.form-group select { width:100%; padding:10px; border:2px solid #e1e5e9; border-radius:8px; font-size:1em }
    .form-group input.error,.form-group select.error { border-color:#e74c3c }
    .required { color:#e74c3c }
    .generate-btn { background:linear-gradient(135deg,#667eea,#764ba2); color:#fff; border:none; padding:12px 30px; border-radius:30px; cursor:pointer; font-size:1.1em; font-weight:500; margin-top:10px }
    .error-message { background:#fee; border:1px solid #e74c3c; color:#c0392b; padding:10px; border-radius:8px; display:none; margin-bottom:15px }
    .loading { text-align:center; padding:20px; display:none }
    .loading-spinner { width:40px; height:40px; border:4px solid #f3f3f3; border-top:4px solid #667eea; border-radius:50%; animation:spin 1s linear infinite; margin:10px auto }
    @keyframes spin { 0%{transform:rotate(0)}100%{transform:rotate(360deg)} }
    .results { background:#fff; border-radius:15px; padding:30px; box-shadow:0 5px 15px rgba(0,0,0,0.1); display:none; margin-bottom:30px }
    .input-summary { background:#f0f4ff; border-left:4px solid #667eea; padding:15px; border-radius:8px; margin-bottom:20px }
    .input-summary h3 { color:#667eea; margin-bottom:10px; font-weight:500 }
    .summary-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:10px }
    .summary-item { display:flex; justify-content:space-between; padding:5px 0; border-bottom:1px solid #e1e5e9 }
    .summary-item:last-child { border-bottom:none }
    .chart-info { background:#f8f9fa; border-left:4px solid #667eea; padding:15px; border-radius:8px; margin-bottom:20px }
    .charts-container { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; margin-bottom:20px }
    .chart-container { background:#f8f9fa; border-left:4px solid #667eea; padding:15px; border-radius:8px; text-align:center }
    .predictions { margin-top:20px }
    .prediction-section { background:#f8f9fa; border-left:4px solid #667eea; padding:15px; border-radius:8px; margin-bottom:15px }
    .download-btn { background:#27ae60; color:#fff; border:none; padding:10px 25px; border-radius:25px; cursor:pointer; font-size:1em; font-weight:500 }
    @media(max-width:768px){ .form-grid,.summary-grid,.charts-container{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üåü Nakshatra Vidhi üåü</h1>
      <p>Complete Vedic Astrology Chart Generator</p>
    </div>

    <div class="form-container">
      <div class="error-message" id="errorMessage">
        <ul id="errorList"></ul>
      </div>
      <form id="horoscopeForm">
        <div class="form-grid">
          <div class="form-section">
            <h3>üìÖ Basic Birth Information</h3>
            <div class="form-group">
              <label for="fullName">Full Name <span class="required">*</span></label>
              <input type="text" id="fullName" name="fullName" placeholder="Enter your full name">
            </div>
            <div class="form-group">
              <label for="gender">Gender <span class="required">*</span></label>
              <select id="gender" name="gender">
                <option value="">Select Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="form-group">
              <label for="birthDate">Date of Birth <span class="required">*</span></label>
              <input type="date" id="birthDate" name="birthDate">
            </div>
            <div class="form-group">
              <label for="birthTime">Time of Birth <span class="required">*</span></label>
              <input type="time" id="birthTime" name="birthTime">
            </div>
          </div>

          <div class="form-section">
            <h3>üìç Birth Location</h3>
            <div class="form-group">
              <label for="birthPlace">Birth Place <span class="required">*</span></label>
              <input type="text" id="birthPlace" name="birthPlace" placeholder="City, State, Country">
            </div>
            <div class="form-group">
              <label for="latitude">Latitude <span class="required">*</span></label>
              <input type="number" id="latitude" name="latitude" step="0.0001" placeholder="e.g., 28.6139">
            </div>
            <div class="form-group">
              <label for="longitude">Longitude <span class="required">*</span></label>
              <input type="number" id="longitude" name="longitude" step="0.0001" placeholder="e.g., 77.2090">
            </div>
            <div class="form-group">
              <label for="timezone">Timezone <span class="required">*</span></label>
              <select id="timezone" name="timezone">
                <option value="">Select Timezone</option>
                <option value="5.5">IST (GMT+5:30)</option>
                <option value="0">GMT (GMT+0:00)</option>
                <option value="-5">EST (GMT-5:00)</option>
                <option value="-8">PST (GMT-8:00)</option>
                <option value="1">CET (GMT+1:00)</option>
              </select>
            </div>
          </div>

          <div class="form-section">
            <h3>üèõÔ∏è Regional Preferences</h3>
            <div class="form-group">
              <label for="chartStyle">Chart Style <span class="required">*</span></label>
              <select id="chartStyle" name="chartStyle">
                <option value="">Select Chart Style</option>
                <option value="north">North Indian (Diamond)</option>
                <option value="south">South Indian (Square)</option>
                <option value="east">East Indian (Bengali)</option>
              </select>
            </div>
            <div class="form-group" id="languageGroup" style="display:none;">
              <label for="language">Language <span class="required">*</span></label>
              <select id="language" name="language">
                <option value="">Select Language</option>
                <option value="hindi">Hindi (‡§π‡§ø‡§Ç‡§¶‡•Ä)</option>
                <option value="punjabi">Punjabi (‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä)</option>
                <option value="gujarati">Gujarati (‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä)</option>
                <option value="marathi">Marathi (‡§Æ‡§∞‡§æ‡§†‡•Ä)</option>
                <option value="tamil">Tamil (‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç)</option>
                <option value="telugu">Telugu (‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å)</option>
                <option value="kannada">Kannada (‡≤ï‡≤®‡≥ç‡≤®‡≤°)</option>
                <option value="malayalam">Malayalam (‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç)</option>
                <option value="bengali">Bengali (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ)</option>
                <option value="assamese">Assamese (‡¶Ö‡¶∏‡¶Æ‡ßÄ‡¶Ø‡¶º‡¶æ)</option>
                <option value="odia">Odia (‡¨ì‡¨°‡¨º‡¨ø‡¨Ü)</option>
                <option value="english">English</option>
              </select>
            </div>
            <div class="form-group">
              <label for="ayanamsa">Ayanamsa</label>
              <select id="ayanamsa" name="ayanamsa">
                <option value="lahiri">Lahiri</option>
                <option value="raman">Raman</option>
                <option value="krishnamurti">KP</option>
                <option value="yukteshwar">Yukteshwar</option>
              </select>
            </div>
            <div class="form-group">
              <label for="calendarSystem">Calendar System</label>
              <select id="calendarSystem" name="calendarSystem">
                <option value="lunar">Lunar</option>
                <option value="solar">Solar</option>
              </select>
            </div>
          </div>

          <div class="form-section">
            <h3>üìä Output Options</h3>
            <div class="form-group">
              <label for="reportType">Report Detail Level</label>
              <select id="reportType" name="reportType">
                <option value="basic">Basic Report</option>
                <option value="detailed">Detailed Report</option>
                <option value="comprehensive">Comprehensive Report</option>
              </select>
            </div>
            <div class="form-group">
              <label for="includeDivisional">Divisional Charts</label>
              <select id="includeDivisional" name="includeDivisional">
                <option value="basic">D1 (Birth Chart) Only</option>
                <option value="essential">D1 + D9 (Navamsa)</option>
                <option value="extended">D1 + D9 + D10 + D12</option>
                <option value="complete">All Major Divisional Charts</option>
              </select>
            </div>
          </div>
        </div>
        <button type="submit" class="generate-btn" id="generateBtn">‚ú® Generate Horoscope ‚ú®</button>
      </form>
    </div>

    <div class="loading" id="loading">
      <div class="loading-spinner"></div>
      <h3>Calculating Charts...</h3>
    </div>

    <div class="results" id="results">
      <h2>üåü Your Complete Nakshatra Vidhi Report üåü</h2>
      <div class="input-summary" id="inputSummary"></div>
      <div class="chart-info">
        <h3>Basic Astrological Information</h3>
        <p><strong>Ascendant:</strong> <span id="ascendant">-</span></p>
        <p><strong>Moon Sign:</strong> <span id="moonSign">-</span></p>
        <p><strong>Sun Sign:</strong> <span id="sunSign">-</span></p>
        <p><strong>Nakshatra:</strong> <span id="nakshatra">-</span></p>
        <p><strong>Pada:</strong> <span id="pada">-</span></p>
      </div>
      <div class="charts-container" id="chartsContainer"></div>
      <div class="predictions" id="predictions"></div>
      <div style="text-align:center;margin-top:20px;">
        <button class="download-btn" onclick="downloadPDF()">üìÑ Download PDF</button>
        <button class="download-btn" onclick="generateNewHoroscope()" style="background:#3498db;">üîÑ New Horoscope</button>
      </div>
    </div>
  </div>

  <script>
    // Language dropdown population
    const languageMap = {
      north: ['Hindi (‡§π‡§ø‡§Ç‡§¶‡•Ä)','Punjabi (‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä)','Gujarati (‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä)','Marathi (‡§Æ‡§∞‡§æ‡§†‡•Ä)','English'],
      south: ['Tamil (‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç)','Telugu (‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å)','Kannada (‡≤ï‡≤®‡≥ç‡≤®‡≤°)','Malayalam (‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç)','English'],
      east: ['Bengali (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ)','Assamese (‡¶Ö‡¶∏‡¶Æ‡ßÄ‡¶Ø‡¶º‡¶æ)','Odia (‡¨ì‡¨°‡¨º‡¨ø‡¨Ü)','English']
    };
    document.getElementById('chartStyle').addEventListener('change',function(){
      const opts=languageMap[this.value]||[];
      const sel=document.getElementById('language');
      sel.innerHTML='<option value="">Select Language</option>'+opts.map(t=>`<option value="${t.split(' ')[0].toLowerCase()}">${t}</option>`).join('');
      document.getElementById('languageGroup').style.display=opts.length?'block':'none';
    });

    // Other initialization and functions go here...
    // calculateHoroscope uses original 3-arg calculatePlanetaryPositions(jd,lat,lng)

  </script>
</body>
</html>
